<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Techshack 2018-50 | Enqueue Zero</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Enqueue Zero is publishing code principles.">
    
    <link rel="preload" href="/assets/css/0.styles.472f46d1.css" as="style"><link rel="preload" href="/assets/js/app.26662bcd.js" as="script"><link rel="preload" href="/assets/js/6.d2240214.js" as="script"><link rel="preload" href="/assets/js/139.789324e5.js" as="script"><link rel="preload" href="/assets/js/3.dd706b41.js" as="script"><link rel="prefetch" href="/assets/js/1.f7157d85.js"><link rel="prefetch" href="/assets/js/10.bb89159d.js"><link rel="prefetch" href="/assets/js/100.696fc0f0.js"><link rel="prefetch" href="/assets/js/101.a1c3f849.js"><link rel="prefetch" href="/assets/js/102.bfa743be.js"><link rel="prefetch" href="/assets/js/103.694af51d.js"><link rel="prefetch" href="/assets/js/104.c21c3757.js"><link rel="prefetch" href="/assets/js/105.d5841585.js"><link rel="prefetch" href="/assets/js/106.9cf7fa00.js"><link rel="prefetch" href="/assets/js/107.1ec93d70.js"><link rel="prefetch" href="/assets/js/108.0b8763b2.js"><link rel="prefetch" href="/assets/js/109.e7196d2e.js"><link rel="prefetch" href="/assets/js/11.e30c030f.js"><link rel="prefetch" href="/assets/js/110.a6dd1b2d.js"><link rel="prefetch" href="/assets/js/111.77cce519.js"><link rel="prefetch" href="/assets/js/112.70165eb2.js"><link rel="prefetch" href="/assets/js/113.3fa50ee2.js"><link rel="prefetch" href="/assets/js/114.31c8c10f.js"><link rel="prefetch" href="/assets/js/115.af04f95c.js"><link rel="prefetch" href="/assets/js/116.457c2566.js"><link rel="prefetch" href="/assets/js/117.c43e188a.js"><link rel="prefetch" href="/assets/js/118.8cf2c53e.js"><link rel="prefetch" href="/assets/js/119.bd688ff9.js"><link rel="prefetch" href="/assets/js/12.3e81efff.js"><link rel="prefetch" href="/assets/js/120.dc1164f5.js"><link rel="prefetch" href="/assets/js/121.f8bd20ba.js"><link rel="prefetch" href="/assets/js/122.58c1b292.js"><link rel="prefetch" href="/assets/js/123.3ab17f6c.js"><link rel="prefetch" href="/assets/js/124.79a8fefc.js"><link rel="prefetch" href="/assets/js/125.bb87430b.js"><link rel="prefetch" href="/assets/js/126.de1343ef.js"><link rel="prefetch" href="/assets/js/127.d66cf797.js"><link rel="prefetch" href="/assets/js/128.c2ce57e8.js"><link rel="prefetch" href="/assets/js/129.e0515a98.js"><link rel="prefetch" href="/assets/js/13.3ae4e3c9.js"><link rel="prefetch" href="/assets/js/130.b198674a.js"><link rel="prefetch" href="/assets/js/131.b44003aa.js"><link rel="prefetch" href="/assets/js/132.9ce0efcd.js"><link rel="prefetch" href="/assets/js/133.c5ff5656.js"><link rel="prefetch" href="/assets/js/134.27dfad96.js"><link rel="prefetch" href="/assets/js/135.1a6c5976.js"><link rel="prefetch" href="/assets/js/136.a40474aa.js"><link rel="prefetch" href="/assets/js/137.337a587b.js"><link rel="prefetch" href="/assets/js/138.c0a1d2f5.js"><link rel="prefetch" href="/assets/js/14.6745f1f0.js"><link rel="prefetch" href="/assets/js/140.0f6046b7.js"><link rel="prefetch" href="/assets/js/141.ca8677a9.js"><link rel="prefetch" href="/assets/js/142.7cd41612.js"><link rel="prefetch" href="/assets/js/143.4e06cdc6.js"><link rel="prefetch" href="/assets/js/144.30a011d9.js"><link rel="prefetch" href="/assets/js/145.616e4d0c.js"><link rel="prefetch" href="/assets/js/146.9f8b8212.js"><link rel="prefetch" href="/assets/js/147.aa478e29.js"><link rel="prefetch" href="/assets/js/148.3114d5cd.js"><link rel="prefetch" href="/assets/js/149.f8711773.js"><link rel="prefetch" href="/assets/js/15.2f559067.js"><link rel="prefetch" href="/assets/js/150.66da4609.js"><link rel="prefetch" href="/assets/js/151.9a722cf9.js"><link rel="prefetch" href="/assets/js/152.c625b811.js"><link rel="prefetch" href="/assets/js/153.6f67989f.js"><link rel="prefetch" href="/assets/js/154.8d3771fd.js"><link rel="prefetch" href="/assets/js/155.db2eb76a.js"><link rel="prefetch" href="/assets/js/156.d5dd02f5.js"><link rel="prefetch" href="/assets/js/157.12f4dc82.js"><link rel="prefetch" href="/assets/js/158.106505d8.js"><link rel="prefetch" href="/assets/js/159.a2dbf072.js"><link rel="prefetch" href="/assets/js/16.b9adde67.js"><link rel="prefetch" href="/assets/js/160.3145ef30.js"><link rel="prefetch" href="/assets/js/161.25da45f5.js"><link rel="prefetch" href="/assets/js/162.a65448a4.js"><link rel="prefetch" href="/assets/js/163.f07fa25d.js"><link rel="prefetch" href="/assets/js/164.467c6d5c.js"><link rel="prefetch" href="/assets/js/17.01834c30.js"><link rel="prefetch" href="/assets/js/18.9956aed9.js"><link rel="prefetch" href="/assets/js/19.d99e88b1.js"><link rel="prefetch" href="/assets/js/2.0d8a973f.js"><link rel="prefetch" href="/assets/js/20.8ce58444.js"><link rel="prefetch" href="/assets/js/21.8e95e990.js"><link rel="prefetch" href="/assets/js/22.46dc304c.js"><link rel="prefetch" href="/assets/js/23.1ad9ea02.js"><link rel="prefetch" href="/assets/js/24.32437043.js"><link rel="prefetch" href="/assets/js/25.e3764fbe.js"><link rel="prefetch" href="/assets/js/26.e4eec541.js"><link rel="prefetch" href="/assets/js/27.54c6db2e.js"><link rel="prefetch" href="/assets/js/28.8dc6cb87.js"><link rel="prefetch" href="/assets/js/29.4d3624fc.js"><link rel="prefetch" href="/assets/js/30.c4d8ab26.js"><link rel="prefetch" href="/assets/js/31.d28673cb.js"><link rel="prefetch" href="/assets/js/32.51d979f3.js"><link rel="prefetch" href="/assets/js/33.7359ba2a.js"><link rel="prefetch" href="/assets/js/34.c3f19c8f.js"><link rel="prefetch" href="/assets/js/35.1613123f.js"><link rel="prefetch" href="/assets/js/36.5a82821a.js"><link rel="prefetch" href="/assets/js/37.b95059f5.js"><link rel="prefetch" href="/assets/js/38.67082dba.js"><link rel="prefetch" href="/assets/js/39.f9e197d7.js"><link rel="prefetch" href="/assets/js/4.29da6077.js"><link rel="prefetch" href="/assets/js/40.309fa7cc.js"><link rel="prefetch" href="/assets/js/41.12e2904c.js"><link rel="prefetch" href="/assets/js/42.60c54b7c.js"><link rel="prefetch" href="/assets/js/43.93d5d55c.js"><link rel="prefetch" href="/assets/js/44.c7972aa3.js"><link rel="prefetch" href="/assets/js/45.0e7f822e.js"><link rel="prefetch" href="/assets/js/46.6646cc92.js"><link rel="prefetch" href="/assets/js/47.ef2ff153.js"><link rel="prefetch" href="/assets/js/48.aba7bfcd.js"><link rel="prefetch" href="/assets/js/49.76ce0dd5.js"><link rel="prefetch" href="/assets/js/50.bfd5ce8a.js"><link rel="prefetch" href="/assets/js/51.78e9f09c.js"><link rel="prefetch" href="/assets/js/52.d84bf105.js"><link rel="prefetch" href="/assets/js/53.63ae3ba7.js"><link rel="prefetch" href="/assets/js/54.c13091c1.js"><link rel="prefetch" href="/assets/js/55.0fd04d7d.js"><link rel="prefetch" href="/assets/js/56.30c3e036.js"><link rel="prefetch" href="/assets/js/57.88f684ac.js"><link rel="prefetch" href="/assets/js/58.b0273999.js"><link rel="prefetch" href="/assets/js/59.2bd4017a.js"><link rel="prefetch" href="/assets/js/60.cb5e31cd.js"><link rel="prefetch" href="/assets/js/61.78c24020.js"><link rel="prefetch" href="/assets/js/62.ed7bb122.js"><link rel="prefetch" href="/assets/js/63.6dc67c03.js"><link rel="prefetch" href="/assets/js/64.ba48b753.js"><link rel="prefetch" href="/assets/js/65.95fb6a85.js"><link rel="prefetch" href="/assets/js/66.cf7b0f4b.js"><link rel="prefetch" href="/assets/js/67.135e02b9.js"><link rel="prefetch" href="/assets/js/68.692785cb.js"><link rel="prefetch" href="/assets/js/69.71acc6d9.js"><link rel="prefetch" href="/assets/js/7.e6dfaa84.js"><link rel="prefetch" href="/assets/js/70.9330fa95.js"><link rel="prefetch" href="/assets/js/71.323daa7b.js"><link rel="prefetch" href="/assets/js/72.0a1f652c.js"><link rel="prefetch" href="/assets/js/73.58f8d79d.js"><link rel="prefetch" href="/assets/js/74.c79161f6.js"><link rel="prefetch" href="/assets/js/75.ebdc4060.js"><link rel="prefetch" href="/assets/js/76.d7c6a683.js"><link rel="prefetch" href="/assets/js/77.1c74ae52.js"><link rel="prefetch" href="/assets/js/78.1435c08f.js"><link rel="prefetch" href="/assets/js/79.550e023e.js"><link rel="prefetch" href="/assets/js/8.9d730b63.js"><link rel="prefetch" href="/assets/js/80.0fcde753.js"><link rel="prefetch" href="/assets/js/81.54ad9ad6.js"><link rel="prefetch" href="/assets/js/82.106f6213.js"><link rel="prefetch" href="/assets/js/83.eb1f77af.js"><link rel="prefetch" href="/assets/js/84.dc27d377.js"><link rel="prefetch" href="/assets/js/85.952de193.js"><link rel="prefetch" href="/assets/js/86.849ef641.js"><link rel="prefetch" href="/assets/js/87.ba839e63.js"><link rel="prefetch" href="/assets/js/88.55c67120.js"><link rel="prefetch" href="/assets/js/89.2b92f963.js"><link rel="prefetch" href="/assets/js/9.4f13d7d8.js"><link rel="prefetch" href="/assets/js/90.599d1ee9.js"><link rel="prefetch" href="/assets/js/91.ca49947d.js"><link rel="prefetch" href="/assets/js/92.fee804a1.js"><link rel="prefetch" href="/assets/js/93.38edda54.js"><link rel="prefetch" href="/assets/js/94.2a5af489.js"><link rel="prefetch" href="/assets/js/95.694d7882.js"><link rel="prefetch" href="/assets/js/96.dbae4a47.js"><link rel="prefetch" href="/assets/js/97.f635273c.js"><link rel="prefetch" href="/assets/js/98.4b13da17.js"><link rel="prefetch" href="/assets/js/99.1c228ad5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.472f46d1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Enqueue Zero</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/soasme/enqueuezero" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/soasme/enqueuezero" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Techshack 2018-50</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/techshack.weekly/2018-50.html#our-learnings-from-adopting-graphql" class="sidebar-link">Our learnings from adopting GraphQL</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#building-services-at-airbnb-part-3" class="sidebar-link">Building Services at Airbnb, Part 3</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#an-analysis-of-network-partitioning-failures-in-cloud-systems" class="sidebar-link">An Analysis of Network-Partitioning Failures in Cloud Systems</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#the-distributional-little-s-law-and-its-applications" class="sidebar-link">The Distributional Little's Law And Its Applications</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#stack-overflow-how-we-do-monitoring-2018-edition" class="sidebar-link">Stack Overflow: How We Do Monitoring - 2018 Edition</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#deep-learning-the-final-frontier-for-signal-processing-and-time-series-analysis" class="sidebar-link">Deep learning: the final frontier for signal processing and time series analysis?</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#github-project-shubheksha-kubernetes-internals" class="sidebar-link">GitHub Project: shubheksha/kubernetes-internals</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/techshack.weekly/2018-50.html#github-project-kinghajj-deque" class="sidebar-link">GitHub Project: kinghajj/deque</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="enqueuezero-techshack-2018-50"><a href="#enqueuezero-techshack-2018-50" class="header-anchor">#</a> EnqueueZero Techshack 2018-50</h1> <div class="techshack-header"><p>Kia ora! I am the creator of <strong>Enqueue Zero</strong> (<a href="https://enqueuezero.com">https://enqueuezero.com</a>), a site that explains code principles to Developers/DevOps/Sysadmins. This site is updated under a single man team since 2018. The `EnqueueZero Techshack` series is comprised of a bunch of interesting posts I wrote or found on the Internet. More importantly, I hope these posts would please you.</p><p></p><div><p>
      Please follow Twitter account <a href="https://twitter.com/enqueuezero">@enqueuezero</a> for the updates.  Happy exploring!
    </p></div></div> <h2 id="our-learnings-from-adopting-graphql"><a href="#our-learnings-from-adopting-graphql" class="header-anchor">#</a> Our learnings from adopting GraphQL</h2> <p><a href="https://medium.com/netflix-techblog/our-learnings-from-adopting-graphql-f099de39ae5f" target="_blank" rel="noopener noreferrer">Read the Netflix Technology Blog post<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Below is a high-level overview of a Netflix team introducing GraphQL to the technology stack for improving the performance of the application.</p> <p><img src="/static/images/readings-2018-50-netflix-graphql.png" alt="Architecture before and after GraphQL" title="Architecture before and after GraphQL"></p> <p>The benefits are:</p> <ul><li>Redistributing load and payload optimization.</li> <li>Reusable abstractions.</li> <li>Chaining type systems</li> <li>Partial data will return even if any resolver of the GraphQL query fails</li></ul> <p>The growing pains are:</p> <ul><li>Resolvers are isolated units, so they need to add a cache layer for resolvers.</li> <li>Debugging is insufficient. Their solution is to add logging to the GraphQL response payload.</li></ul> <h2 id="building-services-at-airbnb-part-3"><a href="#building-services-at-airbnb-part-3" class="header-anchor">#</a> Building Services at Airbnb, Part 3</h2> <p><a href="https://medium.com/airbnb-engineering/building-services-at-airbnb-part-3-ac6d4972fc2d" target="_blank" rel="noopener noreferrer">Read the article<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The 3rd in the series of building services at Airbnb just came.</p> <p>Resilience is a Requirement, Not a Feature. It's about to tackle problems like request spikes, system overload, server resource exhaustion, aggressive retry, cascading failures, etc.</p> <p>The resilience engineering practices include:</p> <ul><li>Async Server Request Processing. The goal is to build highly concurrent, non-blocking applications. It leads to few threads and has better tail latency when under load.</li> <li>Request Queuing. The gaol is to absorb bursty request load and prevent services from failing due to resource exhaustion. The implementation is based on a controlled delay (CoDel) queue with adaptive LIFO (last-in first-out).<a href="https://queue.acm.org/detail.cfm?id=2839461" target="_blank" rel="noopener noreferrer">link<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>Controlled Delay Queue. Use more aggressive timeout when the request queue is not being emptied in N milliseconds.</li> <li>Adaptive LIFO. Use LIFO instead of FIFO when a queue is building up.</li></ul></li> <li>Load Shedding.
<ul><li>Service Back Pressure. Start fast-failing inbound requests with a back pressure error until the request queue watermark drops to a safe threshold.</li> <li>API Request Deadline.</li> <li>Client Quota-based Rate Limit. A downstream service cannot send requests over its quota on upstream service.</li></ul></li> <li>Dependency Isolation and Graceful Degradation. Similar to <a href="https://github.com/Netflix/Hystrix/wiki/How-it-Works#isolation" target="_blank" rel="noopener noreferrer">Netflix's Hystrix<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Outlier Server Host Detection. Let the client maintain a list of server hosts, track success rate and response latency of each host, and avoid routing requests to outlier hosts with low success rate and elevated latency. It's implemented by <a href="https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/outlier#arch-overview-outlier-detection" target="_blank" rel="noopener noreferrer">Envoy<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <h2 id="an-analysis-of-network-partitioning-failures-in-cloud-systems"><a href="#an-analysis-of-network-partitioning-failures-in-cloud-systems" class="header-anchor">#</a> An Analysis of Network-Partitioning Failures in Cloud Systems</h2> <p><a href="https://www.usenix.org/system/files/osdi18-alquraan.pdf" target="_blank" rel="noopener noreferrer">Read the paper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Finding 1: A large percentage (80%) of the studied failures have a catastrophic impact, with data loss being the most common (27%).</p> <ul><li><strong>Data loss</strong> 26.6%</li> <li><strong>Stale read</strong> 13.2%</li> <li><strong>Broken locks</strong> 8.2%</li> <li><strong>System crash/hang</strong> 8.1%</li> <li><strong>Data unavailability</strong> 6.6%</li> <li><strong>Reappearance of deleted data</strong> 6.6%</li> <li><strong>Data corruption</strong> 5.1%</li> <li><strong>Dirty read</strong> 5.1%</li> <li>Performance degradation 19.1%</li> <li>Other 1.4%</li></ul> <p>Finding 2: The majority (90%) of the failures are silent, whereas the rest produce warnings that are unatonable.</p> <p>Finding 3: Twenty one percent of the failures lead to permanent damage to the system. This damage persists even after the network partition heals.</p> <p>Finding 4. Leader election, configuration change, request routing, and data consolidation are the most vulnerable mechanisms to network partitioning.</p> <p>Finding 5. The majority (64%) of the failures either do not require any client access or require client access to only one side of the network partition.</p> <p>Finding 6. While the majority (69%) of the failures require a complete partition, a significant percentage of them (29%) are caused by partial partitions</p> <p>Finding 7. A majority (83%) of the failures triggered by a network partition require an additional three or fewer input events to manifest.</p> <p>Finding 8. All of the failures that involve multiple events only manifest if the events happen in a specific order.</p> <p>Finding 9. The majority (88%) of the failures manifest by isolating a single node, with 45% of the failures manifest by isolating any replica.</p> <p>Finding 10. The majority (80%) of the failures are either deterministic or have known timing constraints.</p> <p>Finding 11. The resolution of 47% of the failures required redesigning a system mechanism.</p> <p>Finding 12. All failures can be reproduced on a cluster of five nodes, with the majority (83%) of the failures being reproducible with three nodes only.</p> <p>Finding 13. The majority of the failures (93%) can be reproduced through tests by using a fault injection framework such as NEAT.</p> <h2 id="the-distributional-little-s-law-and-its-applications"><a href="#the-distributional-little-s-law-and-its-applications" class="header-anchor">#</a> The Distributional Little's Law And Its Applications</h2> <p><a href="http://web.mit.edu/dbertsim/www/papers/Queuing%20Theory/The%20distributional%20Little's%20law%20and%20its%20applications.pdf" target="_blank" rel="noopener noreferrer">Read the paper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>The paper discusses the distributional Little's law and examines the application in a variety of queueing system. In short, it's about quantifying the number and the time spent in a queueing system under FIFO. As a result, the distributional Little's law is a powerful tool for the derivation of performance measures in a queueing system.</p> <p>Add-up: <a href="https://en.wikipedia.org/wiki/Little%27s_law" target="_blank" rel="noopener noreferrer">Little's Law<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language- extra-class"><pre class="language-text"><code>L = λ W

L: The average number
λ: the long-term average effective arrival rate
W: the average time spent
</code></pre></div><h2 id="stack-overflow-how-we-do-monitoring-2018-edition"><a href="#stack-overflow-how-we-do-monitoring-2018-edition" class="header-anchor">#</a> Stack Overflow: How We Do Monitoring - 2018 Edition</h2> <p><a href="https://nickcraver.com/blog/2018/11/29/stack-overflow-how-we-do-monitoring/" target="_blank" rel="noopener noreferrer">Read original post<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The operation engineers in Stack Overflow care three major things:</p> <ul><li>Logs</li> <li>Health Checks</li> <li>Metrics</li></ul> <p>They use tools <a href="https://github.com/bosun-monitor/" target="_blank" rel="noopener noreferrer">Bosun<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, Grafana, PagerDuty, Pingdom, Opserve.r, MiniProfiler, etc.</p> <p>The pain point is it's not clear which service is the root of cause when an incident is ongoing, considering the system has many services and dependencies. Another potential improvement is to gain more from reading metrics.</p> <h2 id="deep-learning-the-final-frontier-for-signal-processing-and-time-series-analysis"><a href="#deep-learning-the-final-frontier-for-signal-processing-and-time-series-analysis" class="header-anchor">#</a> Deep learning: the final frontier for signal processing and time series analysis?</h2> <p><a href="https://medium.com/@alexrachnog/deep-learning-the-final-frontier-for-signal-processing-and-time-series-analysis-734307167ad6" target="_blank" rel="noopener noreferrer">Read original post<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ul><li>Systems like Cosmic, economy, and human creates time series data.</li> <li>The classic approaches for processing time series data includes:
<ul><li>Time domain analysis</li> <li>Frequency domain analysis</li> <li>Nearest neighbors analysis</li> <li>(S)AR(I)MA(X) models</li> <li>Decomposition</li> <li>Nonlinear dynamics</li> <li>Machine Learning</li></ul></li> <li>The deep learning approaches for processing time series data includes:
<ul><li>RNN</li> <li>CNN</li> <li>Autoregressive CNN</li> <li>Clustering</li> <li>Anomaly detection</li> <li>Hybrid</li></ul></li> <li>Conclusion: Autoregressive CNN &gt; CNN &gt; RNN. If possible, combine DL with mathematical modeling.</li></ul> <h2 id="github-project-shubheksha-kubernetes-internals"><a href="#github-project-shubheksha-kubernetes-internals" class="header-anchor">#</a> GitHub Project: <a href="https://github.com/shubheksha/kubernetes-internals" target="_blank" rel="noopener noreferrer">shubheksha/kubernetes-internals<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>This is a collection of resources that shed light on the inner workings of Kubernetes</p> <p>Instead of just starring the project, I quickly scanned through some documents. I'll present more simplified notes later.</p> <ul><li><a href="https://github.com/jamiehannaford/what-happens-when-k8s" target="_blank" rel="noopener noreferrer">What happens when k8s<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: The long post explains what happens when typing <code>kubectl</code>. It involves below steps:
<ul><li>Kubectl loads <code>.kubeconfig</code> and its context.</li> <li>Kubectl generates the token in HTTP headers.</li> <li>Kube-apiserver validates the token (authentication).</li> <li>Kube-apiserver validates if the owner of the token can perform the action (authorization, RBAC).</li> <li>Kube-apiserver validates if the certain action can be applied to the node (admission controllers)</li> <li>Etcd save payloads.</li> <li>Initializers performs some logics before the resource is visible to the apiserver or scheduler. (optional, based on if the resource type has initializers)</li> <li>Controllers like deployments controller, replicasets controller setup resources.</li> <li>Scheduler schedules resources to certain nodes or pods.</li> <li>Kubelet in worker node syncs resources regularly.</li> <li>Kubelet instantiates resources, for example, CRI starting containers, CNI assigning IPs and setting up network bridges, overlay networking updating inter-host networking rules.</li> <li>Container is up.</li></ul></li> <li><a href="http://www.dasblinkenlichten.com/kubernetes-101-networking/" target="_blank" rel="noopener noreferrer">Kubernetes 101 Networking<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>: This post explains the network flow between pods. In particular, the networking in this post refers to the physical network that connects hosts together. It's a nice post demonstrating the network flow based on utilities like tcpdump, iptables, etc.
<ul><li>All containers in a pod shares the same IP. The diagram is like below:
<ul><li>the rest of the network -&gt; node eth0</li> <li>node eth0 -&gt; docker0</li> <li>docker0 -&gt; veth0</li> <li>veth0 -&gt; Pod1container1</li> <li>veth0 -&gt; Pod1container2</li> <li>docker0 -&gt; vethN</li> <li>vethN -&gt; Pod2container1</li> <li>...</li></ul></li> <li>Kubernetes <code>Service</code> provides load balancing mechanism across pods hosting the same service. The diagram is like below:
<ul><li>iptables on each host have rules for redirecting traffic from serviceIp:servicePort to localhost:hostPort.</li> <li>kubernetes-proxy decides which host should load balance to.</li></ul></li></ul></li> <li><a href="https://medium.com/google-cloud/understanding-kubernetes-networking-pods-7117dd28727" target="_blank" rel="noopener noreferrer">Understanding kubernetes networking: pods<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
<ul><li>A pod consists of one or more containers that are collocated on the same host, and are configured to share a network stack and other resources such as volumes.</li> <li>&quot;Share a network stack&quot; means all the containers in a pod can reach each other on localhost.</li> <li>The connection between a container and the bridge is established over a pair of linked virtual ethernet devices, one in the container network namespace and the other in the root network namespace.</li> <li>Kubernetes creates a special container for each pod whose only purpose is to provide a network interface for the other containers. It's implemented by a single <code>pause</code> command sleeping until Kubernetes sending SIGTERM.</li> <li>The <code>veth0</code> interface is created with the <code>pause</code> container and is visible to all other containers in the same pod.</li> <li>Kubernetes uses <code>cbr0</code> (custom bridge) instead of <code>docker0</code>.</li></ul></li></ul> <hr> <h2 id="github-project-kinghajj-deque"><a href="#github-project-kinghajj-deque" class="header-anchor">#</a> GitHub Project: <a href="https://github.com/kinghajj/deque" target="_blank" rel="noopener noreferrer">kinghajj/deque<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <p>A (mostly) lock-free concurrent work-stealing deque in Rust.</p> <p>This module implements the Chase-Lev work stealing deque described in &quot;Dynamic Circular Work-Stealing Deque&quot;.</p> <p>Usage:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> deque<span class="token punctuation">;</span>

<span class="token keyword">let</span> <span class="token punctuation">(</span>worker<span class="token punctuation">,</span> stealer<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token namespace">deque<span class="token punctuation">::</span></span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Only the worker may push/pop</span>
worker<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worker<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Stealers take data from the other end of the deque</span>
worker<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stealer<span class="token punctuation">.</span><span class="token function">steal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Stealers can be cloned to have many stealers stealing in parallel</span>
worker<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> stealer2 <span class="token operator">=</span> stealer<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
stealer2<span class="token punctuation">.</span><span class="token function">steal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>Deque</code> itself is a struct tracking <code>bottom</code>, <code>top</code> and an <code>array</code>. Note that all these values are Atomic values, meaning increasing or decreasing is guaranteed to behave correctly by the CPU:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Deque</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Send</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    bottom<span class="token punctuation">:</span> <span class="token class-name">AtomicIsize</span><span class="token punctuation">,</span>
    top<span class="token punctuation">:</span> <span class="token class-name">AtomicIsize</span><span class="token punctuation">,</span>
    array<span class="token punctuation">:</span> <span class="token class-name">AtomicPtr</span><span class="token operator">&lt;</span><span class="token class-name">Buffer</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Both the worker and stealer have a reference to the deque.</p> <ul><li>Worker can only access to one side of the deque by using the <code>push</code> and <code>pop</code> operation.</li> <li>Stealers can only access to the other side of the deque by using the <code>steal</code> operation.</li></ul> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Worker</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Send</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    deque<span class="token punctuation">:</span> <span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">Deque</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
    marker<span class="token punctuation">:</span> <span class="token class-name">PhantomData</span><span class="token operator">&lt;</span><span class="token class-name">Cell</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">pub</span> <span class="token keyword">struct</span> <span class="token type-definition class-name">Stealer</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Send</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    deque<span class="token punctuation">:</span> <span class="token class-name">Arc</span><span class="token operator">&lt;</span><span class="token class-name">Deque</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note that the field <code>marker</code> ensures the access to the worker is from a single thread at once.</p> <p>When stealing data, there are three possible outcomes:</p> <ul><li>The deque was empty at the time of stealing.</li> <li>The stealer lost the race for stealing data.</li> <li>The stealer has successfully stolen some data.</li></ul> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">enum</span> <span class="token type-definition class-name">Stolen</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span> <span class="token class-name">Empty</span><span class="token punctuation">,</span> <span class="token class-name">Abort</span><span class="token punctuation">,</span> <span class="token class-name">Data</span><span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">}</span>
</code></pre></div><p>An internal circular buffer is used as the intermediate storage of the data in the deque.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">struct</span> <span class="token type-definition class-name">Buffer</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token punctuation">:</span> <span class="token class-name">Send</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    storage<span class="token punctuation">:</span> <span class="token operator">*</span><span class="token keyword">mut</span> <span class="token class-name">T</span><span class="token punctuation">,</span>
    size<span class="token punctuation">:</span> <span class="token keyword">usize</span><span class="token punctuation">,</span>
    prev<span class="token punctuation">:</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Box</span><span class="token operator">&lt;</span><span class="token class-name">Buffer</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The implementation of <code>push</code> has below instructions:</p> <ul><li>Grow the buffer if it is full.</li> <li>Put the data into the array, and increase the bottom value.</li></ul> <p>The implementation of <code>pop</code> has below instructions:</p> <ul><li>Fail fast if the deque is empty.</li> <li>Decrease the bottom value.</li> <li>Get the data from the array.</li> <li>Return the data if no race, otherwise, return nothing.</li></ul> <p>The implementation of <code>steal</code> has below instructions:</p> <ul><li>Get the data from the array.</li> <li>Return the data if no race, otherwise, return nothing.</li></ul> <p>Conclusions:</p> <ul><li>The implementation is heavily based on the implementation using C11
atomics in &quot;Correct and Efficient Work Stealing for Weak Memory Models&quot;.</li> <li>The only potentially lock-synchronized portion of this deque is the
occasional call to the memory allocator when growing the deque. Otherwise
all operations are lock-free.</li></ul> <hr></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/soasme/enqueuezero/edit/master/techshack.weekly/2018-50.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.26662bcd.js" defer></script><script src="/assets/js/6.d2240214.js" defer></script><script src="/assets/js/139.789324e5.js" defer></script><script src="/assets/js/3.dd706b41.js" defer></script>
  </body>
</html>
